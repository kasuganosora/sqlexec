# INSERT / UPDATE / DELETE

DML (Data Manipulation Language) statements are used to insert, update, and delete data in tables.

## INSERT - Inserting Data

### Basic Insert

Insert a single record with specified column names:

```sql
INSERT INTO users (name, email, age) VALUES ('张三', 'zhangsan@example.com', 28);
```

### Omitting Column Names

When inserting values for all columns, you can omit the column names (values must be provided in the order defined by the table):

```sql
INSERT INTO users VALUES (1, '张三', 'zhangsan@example.com', 28, '2026-01-15');
```

### Batch Insert

Insert multiple records at once by separating value tuples with commas:

```sql
INSERT INTO products (name, category, price) VALUES
  ('无线鼠标', '外设', 79.00),
  ('机械键盘', '外设', 299.00),
  ('显示器', '显示', 1599.00),
  ('USB-C 线', '配件', 19.90);
```

Batch inserts are more efficient than inserting records one by one and are recommended for bulk data writing scenarios.

### Inserting Records with Default Values

If a column has a `DEFAULT` value defined, it can be omitted:

```sql
-- The status column has a default value of 'active', no need to specify it explicitly
INSERT INTO users (name, email) VALUES ('李四', 'lisi@example.com');
```

## UPDATE - Updating Data

### Basic Update

```sql
UPDATE users SET email = 'new_email@example.com' WHERE id = 1;
```

### Updating Multiple Columns

```sql
UPDATE users
SET name = '王五',
    email = 'wangwu@example.com',
    age = 30
WHERE id = 2;
```

### Updating with Expressions

```sql
-- Increase prices by 10%
UPDATE products SET price = price * 1.1 WHERE category = '电子';
```

### Conditional Update

```sql
UPDATE orders
SET status = 'expired'
WHERE status = 'pending'
  AND created_at < '2025-01-01';
```

{% hint style="warning" %}
**Warning:** An `UPDATE` without a `WHERE` clause will update all rows in the table. Use with caution.
{% endhint %}

## DELETE - Deleting Data

### Basic Delete

```sql
DELETE FROM users WHERE id = 100;
```

### Conditional Delete

```sql
DELETE FROM logs WHERE created_at < '2024-01-01';
```

### Delete with Combined Conditions

```sql
DELETE FROM sessions
WHERE expired = TRUE
  AND last_active < '2025-06-01';
```

{% hint style="warning" %}
**Warning:** A `DELETE` without a `WHERE` clause will delete all rows in the table. To clear an entire table, consider using `TRUNCATE TABLE` instead, which is more efficient.
{% endhint %}

## Return Values

The execution result of DML statements includes the following information:

| Statement | Return Value | Description |
|-----------|-------------|-------------|
| `INSERT` | affected rows | Number of rows successfully inserted |
| `INSERT` | last insert ID | The last ID generated by an auto-increment column |
| `UPDATE` | affected rows | Number of rows actually modified |
| `DELETE` | affected rows | Number of rows deleted |

### Example: Retrieving Return Values

```go
// INSERT returns the last insert ID
result, err := db.Exec("INSERT INTO users (name) VALUES (?)", "张三")
lastID, _ := result.LastInsertId()
affected, _ := result.RowsAffected()
fmt.Printf("Insert successful: ID=%d, affected rows=%d\n", lastID, affected)

// UPDATE returns affected rows
result, err = db.Exec("UPDATE users SET age = ? WHERE name = ?", 30, "张三")
affected, _ = result.RowsAffected()
fmt.Printf("Update successful: affected rows=%d\n", affected)

// DELETE returns affected rows
result, err = db.Exec("DELETE FROM users WHERE status = ?", "inactive")
affected, _ = result.RowsAffected()
fmt.Printf("Delete successful: affected rows=%d\n", affected)
```
